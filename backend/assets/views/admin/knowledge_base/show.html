<!-- View Knowledge Base Entry Modal -->
<div class="fixed inset-0 z-50 bg-black/50" onclick="if(event.target === this) this.remove()">
    <div class="fixed inset-y-0 right-0 w-full max-w-3xl bg-background shadow-xl overflow-hidden flex flex-col"
         onclick="event.stopPropagation()">
        <!-- Header -->
        <div class="flex items-center justify-between px-6 py-4 border-b">
            <h2 class="text-lg font-semibold">{{ item.name }}</h2>
            <button onclick="this.closest('.fixed').remove()"
                class="inline-flex items-center justify-center rounded-md h-8 w-8 hover:bg-accent">
                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>

        <!-- Content -->
        <div class="flex-1 overflow-y-auto p-6 space-y-6">
            <!-- Metadata Grid -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-xs font-medium text-muted-foreground uppercase tracking-wider">Category</label>
                    <div class="mt-1">
                        <span class="inline-flex items-center rounded-md bg-primary/10 px-2 py-1 text-sm font-medium text-primary">
                            {{ item.category }}
                        </span>
                    </div>
                </div>

                <div>
                    <label class="text-xs font-medium text-muted-foreground uppercase tracking-wider">Priority</label>
                    <div class="mt-1">
                        {% if item.priority %}
                            {% if item.priority == "high" %}
                            <span class="inline-flex items-center gap-1 rounded-full bg-red-500/10 px-2 py-1 text-sm font-medium text-red-600">
                                High
                            </span>
                            {% elif item.priority == "medium" %}
                            <span class="inline-flex items-center gap-1 rounded-full bg-yellow-500/10 px-2 py-1 text-sm font-medium text-yellow-600">
                                Medium
                            </span>
                            {% else %}
                            <span class="inline-flex items-center gap-1 rounded-full bg-blue-500/10 px-2 py-1 text-sm font-medium text-blue-600">
                                Low
                            </span>
                            {% endif %}
                        {% else %}
                        <span class="text-sm text-muted-foreground">Not set</span>
                        {% endif %}
                    </div>
                </div>

                {% if item.component %}
                <div>
                    <label class="text-xs font-medium text-muted-foreground uppercase tracking-wider">Component</label>
                    <div class="mt-1 text-sm">{{ item.component }}</div>
                </div>
                {% endif %}

                {% if item.section %}
                <div>
                    <label class="text-xs font-medium text-muted-foreground uppercase tracking-wider">Section</label>
                    <div class="mt-1 text-sm">{{ item.section }}</div>
                </div>
                {% endif %}

                <div>
                    <label class="text-xs font-medium text-muted-foreground uppercase tracking-wider">Status</label>
                    <div class="mt-1">
                        {% if item.is_active %}
                        <span class="inline-flex items-center gap-1 rounded-full bg-green-500/10 px-2 py-1 text-sm font-medium text-green-600">
                            <span class="h-1.5 w-1.5 rounded-full bg-green-500"></span>
                            Active
                        </span>
                        {% else %}
                        <span class="inline-flex items-center gap-1 rounded-full bg-muted px-2 py-1 text-sm font-medium text-muted-foreground">
                            <span class="h-1.5 w-1.5 rounded-full bg-muted-foreground"></span>
                            Inactive
                        </span>
                        {% endif %}
                    </div>
                </div>

                {% if item.token_estimate %}
                <div>
                    <label class="text-xs font-medium text-muted-foreground uppercase tracking-wider">Token Estimate</label>
                    <div class="mt-1 text-sm">~{{ item.token_estimate }} tokens</div>
                </div>
                {% endif %}
            </div>

            <!-- Relevance Tags -->
            {% if item.relevance_tags %}
            <div>
                <label class="text-xs font-medium text-muted-foreground uppercase tracking-wider">Relevance Tags</label>
                <div class="mt-2 flex flex-wrap gap-2">
                    {% for tag in item.relevance_tags %}
                    <span class="inline-flex items-center rounded-md bg-muted px-2.5 py-1 text-sm font-medium text-muted-foreground">
                        {{ tag }}
                    </span>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Content -->
            <div>
                <label class="text-xs font-medium text-muted-foreground uppercase tracking-wider">Content</label>
                <div class="mt-2 rounded-lg border bg-muted/30 p-4">
                    <pre class="text-sm font-mono whitespace-pre-wrap break-words">{{ item.content }}</pre>
                </div>
            </div>

            <!-- Metadata -->
            <div class="flex items-center justify-between text-xs text-muted-foreground">
                <div>Version: {{ item.version or 1 }}</div>
                <div>Last updated: {{ item.updated_at | date(format="%Y-%m-%d %H:%M") }}</div>
            </div>
        </div>

        <!-- Footer -->
        <div class="flex items-center justify-end gap-2 px-6 py-4 border-t bg-muted/30">
            <button onclick="this.closest('.fixed').remove()"
                class="inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2
                       border bg-background shadow-sm hover:bg-accent hover:text-accent-foreground">
                Close
            </button>
            <button hx-get="/admin/knowledge-bases/{{ item.id }}/edit" hx-target="#modal-container" hx-swap="innerHTML"
                onclick="this.closest('.fixed').remove()"
                class="inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium h-9 px-4 py-2
                       bg-primary text-primary-foreground shadow-sm hover:bg-primary/90">
                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" />
                </svg>
                Edit
            </button>
        </div>
    </div>
</div>
