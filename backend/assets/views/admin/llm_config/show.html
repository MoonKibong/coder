<!-- View LLM Config Modal -->
<div class="fixed inset-0 z-50 bg-black/50" onclick="if(event.target === this) this.remove()">
    <div class="fixed inset-y-0 right-0 w-full max-w-2xl bg-background shadow-xl overflow-hidden flex flex-col"
         onclick="event.stopPropagation()">
        <!-- Header -->
        <div class="flex items-center justify-between px-6 py-4 border-b">
            <div class="flex items-center gap-3">
                <h2 class="text-lg font-semibold">{{ item.name }}</h2>
                {% if item.is_active %}
                <span class="inline-flex items-center gap-1 rounded-full bg-green-500/10 px-2 py-1 text-xs font-medium text-green-600">
                    <span class="h-1.5 w-1.5 rounded-full bg-green-500 animate-pulse"></span>
                    Active
                </span>
                {% else %}
                <span class="inline-flex items-center gap-1 rounded-full bg-muted px-2 py-1 text-xs font-medium text-muted-foreground">
                    <span class="h-1.5 w-1.5 rounded-full bg-muted-foreground"></span>
                    Inactive
                </span>
                {% endif %}
            </div>
            <button onclick="this.closest('.fixed').remove()"
                class="inline-flex items-center justify-center rounded-md h-8 w-8 hover:bg-accent">
                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>

        <!-- Content -->
        <div class="flex-1 overflow-y-auto p-6">
            <div class="space-y-6">
                <!-- Connection Info -->
                <div class="space-y-4 p-4 rounded-lg border bg-muted/30">
                    <h3 class="text-sm font-medium">Connection Settings</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-1">
                            <dt class="text-xs font-medium text-muted-foreground">Provider</dt>
                            <dd class="text-sm">
                                {% if item.provider == "ollama" %}
                                <span class="inline-flex items-center gap-1 rounded-md bg-purple-500/10 px-2 py-1 text-xs font-medium text-purple-600">
                                    <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
                                    Ollama
                                </span>
                                {% elif item.provider == "llama_cpp" %}
                                <span class="inline-flex items-center gap-1 rounded-md bg-orange-500/10 px-2 py-1 text-xs font-medium text-orange-600">
                                    <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
                                    llama.cpp
                                </span>
                                {% else %}
                                <span class="inline-flex items-center gap-1 rounded-md bg-secondary px-2 py-1 text-xs font-medium">
                                    {{ item.provider }}
                                </span>
                                {% endif %}
                            </dd>
                        </div>
                        <div class="space-y-1">
                            <dt class="text-xs font-medium text-muted-foreground">Model</dt>
                            <dd class="text-sm font-mono">{{ item.model_name }}</dd>
                        </div>
                        <div class="space-y-1 col-span-full">
                            <dt class="text-xs font-medium text-muted-foreground">Endpoint URL</dt>
                            <dd class="text-sm">
                                <code class="bg-muted px-2 py-1 rounded font-mono text-xs">{{ item.endpoint_url }}</code>
                            </dd>
                        </div>
                    </div>
                </div>

                <!-- Generation Parameters -->
                <div class="space-y-4 p-4 rounded-lg border">
                    <h3 class="text-sm font-medium">Generation Parameters</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-1">
                            <dt class="text-xs font-medium text-muted-foreground">Temperature</dt>
                            <dd class="text-sm font-mono">{{ item.temperature | default(value=0.7) | round(precision=1) }}</dd>
                        </div>
                        <div class="space-y-1">
                            <dt class="text-xs font-medium text-muted-foreground">Max Tokens</dt>
                            <dd class="text-sm font-mono">{{ item.max_tokens | default(value="4096") }}</dd>
                        </div>
                    </div>
                </div>

                <!-- Security Notice -->
                <div class="flex items-start gap-2 p-3 rounded-lg bg-blue-500/10 border border-blue-500/20">
                    <svg class="h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" />
                    </svg>
                    <p class="text-xs text-blue-700">
                        <strong>Security:</strong> Model name and endpoint are never exposed to the Eclipse plugin or external APIs.
                    </p>
                </div>

                <!-- Timestamps -->
                <div class="pt-4 border-t">
                    <div class="grid grid-cols-2 gap-4 text-xs text-muted-foreground">
                        <div>Created: {{ item.created_at }}</div>
                        {% if item.updated_at %}
                        <div>Updated: {{ item.updated_at }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="flex items-center justify-between px-6 py-4 border-t bg-muted/30">
            <div class="flex items-center gap-2">
                {% if not item.is_active %}
                <button hx-post="/admin/llm-configs/{{ item.id }}/activate" hx-target="#search-result" hx-swap="outerHTML"
                    hx-confirm="Activate this configuration? This will deactivate the current active config."
                    hx-on::after-request="if(event.detail.successful) this.closest('.fixed').remove()"
                    class="inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2
                           border border-green-500/50 text-green-600 hover:bg-green-500/10">
                    <svg class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1012.728 0M12 3v9" />
                    </svg>
                    Activate
                </button>
                {% endif %}
                <button hx-delete="/admin/llm-configs/{{ item.id }}" hx-target="closest .fixed" hx-swap="delete"
                    hx-confirm="Are you sure you want to delete this configuration?"
                    class="inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2
                           border border-destructive/50 text-destructive hover:bg-destructive/10">
                    Delete
                </button>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="this.closest('.fixed').remove()"
                    class="inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2
                           border bg-background shadow-sm hover:bg-accent hover:text-accent-foreground">
                    Close
                </button>
                <button hx-get="/admin/llm-configs/{{ item.id }}/edit" hx-target="#modal-container" hx-swap="innerHTML"
                    class="inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2
                           bg-primary text-primary-foreground shadow-sm hover:bg-primary/90">
                    Edit
                </button>
            </div>
        </div>
    </div>
</div>
